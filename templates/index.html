{% extends '_base.html' %}


{% block content %}
<div class="container-fluid">

    {% for photo in COPY.photos %}
        <div class="col-sm-4 col-md-3 frame" data-audio="{{photo.audio}}">
          <img src="https://s3.amazonaws.com/wbez-dailygraphics/election-vox/{{photo.url}}" class="img-responsive" alt="Responsive image">
          <div class="location">{{photo.location}}</div>
          <div class="title">{{photo.title}}</div>
          <div class="main-caption visible-xs">{{photo.caption}}</div>
          {% include '_player.html' %}
        </div>
        {% if loop.index is divisibleby 4 %}
          <div class="clearfix visible-lg visible-md"></div>
        {% endif %}

        {% if loop.index is divisibleby 3 %}
          <div class="clearfix visible-sm"></div>
        {% endif %}
    {% endfor %}

</div>

<!-- Modal -->
<div class="modal fade" id="photoModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
        <div class="modal-caption">
            <div class="caption-text">Caption</div>
        </div>
      <div class="modal-body">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
      </div>
    </div>
  </div>
</div>

{% endblock content %}

{% block extra_foot %}

<script>
$( document ).ready(function() {

  var state = false;

  var setClick = function(){
    if ($(window).width() > 768) {
      $('.frame').click(function(){
          var image = $(this).children().attr('src');
          var caption = $(this).find('.main-caption').text();
          $('.modal-content').css('background-image', 'url(' + image + ')');
          $('.caption-text').text(caption);
          $('#photoModal').modal()
      })
    } else {
      $('.frame').unbind();
    }
  }
  setClick();

  $( window ).resize(function() {
    setClick();
  });
  
  $("#jquery_jplayer_Hustle").jPlayer({
      ready: function (event) {
          $(this).jPlayer("setMedia", {
              title: "Hustle",
              mp3: "assets/Hustle.mp3"
          });
      },
      cssSelectorAncestor: "#jp_container_Hustle",
      supplied: "mp3", // or multiple like this: "m4a, ogg",
  });

  $("#jquery_jplayer_Whiskey").jPlayer({
      ready: function (event) {
          $(this).jPlayer("setMedia", {
              title: "Whiskey",
              mp3: "assets/Whiskey.mp3"
          });
      },
      cssSelectorAncestor: "#jp_container_Whiskey",
      supplied: "mp3", // or multiple like this: "m4a, ogg",
  });

  // function js_audioPlayer(file) {
  //   $("#jquery_jplayer_" + file).jPlayer( {
  //       ready: function (event) {
  //         $(this).jPlayer("setMedia", {
  //           title: file,
  //           mp3: 'assets/'+file+'.mp3'
  //         });
  //       },
  //       cssSelectorAncestor: "#jp_container_" + file,
  //       supplied: "mp3", // or multiple like this: "m4a, ogg",
  //     });
  //   return;
  // }

  // $('.frame').each(function() { 
  //   console.log($(this).data('audio'));
  //   js_audioPlayer($(this).data('audio'));
  // });

});


</script>

{% endblock extra_foot %}